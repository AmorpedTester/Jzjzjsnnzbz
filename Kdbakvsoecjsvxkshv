-- Create a simple GUI with a button and a text box
local gui = Instance.new("ScreenGui")
gui.Name = "KeySystem"
gui.Enabled = true
gui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- Main Key Entry Panel
local keyPanel = Instance.new("Frame")
keyPanel.Name = "KeyPanel"
keyPanel.Position = UDim2.new(0.5, -100, 0.5, -50)
keyPanel.Size = UDim2.new(0, 200, 0, 100)
keyPanel.BackgroundTransparency = 0.5
keyPanel.Parent = gui

local keyTextBox = Instance.new("TextBox")
keyTextBox.Name = "KeyTextBox"
keyTextBox.Position = UDim2.new(0.5, -75, 0.5, -20)
keyTextBox.Size = UDim2.new(0, 150, 0, 30)
keyTextBox.Text = "Enter your key here..."
keyTextBox.Parent = keyPanel

local validateButton = Instance.new("TextButton")
validateButton.Name = "ValidateButton"
validateButton.Position = UDim2.new(0.5, -50, 0.5, 20)
validateButton.Size = UDim2.new(0, 100, 0, 30)
validateButton.Text = "Check Key"
validateButton.Parent = keyPanel

local getKeyButton = Instance.new("TextButton")
getKeyButton.Name = "GetKeyButton"
getKeyButton.Position = UDim2.new(0.5, -50, 0.8, -15)
getKeyButton.Size = UDim2.new(0, 100, 0, 30)
getKeyButton.Text = "Get Key"
getKeyButton.Parent = gui

local function onSuccess()
    -- Load the script from the URL
    loadstring(game:HttpGet("https://raw.githubusercontent.com/AmorpedTester/Gskdhakbd/main/Emainsded"))()

    -- Destroy the entire GUI after the key is correct
    gui:Destroy()
end

validateButton.MouseButton1Click:Connect(function()
    -- Check if the key is valid
    if keyTextBox.Text == "UnknownHubKey=9kI80FjYTavCX" then
        onSuccess()
    else
        print("Invalid key!")
    end
end)

-- Save the key to a file
local player = game.Players.LocalPlayer
local filePath = player.UserId .. "_UnknownTQHub.txt"

local function saveKeyToFile(key)
    local file = io.open(filePath, "w")
    if file then
        file:write(key)
        file:close()
    else
        warn("Failed to save key to file.")
    end
end

local function loadKeyFromFile()
    local file = io.open(filePath, "r")
    if file then
        local key = file:read("*all")
        file:close()
        return key
    else
        warn("Failed to load key from file.")
        return nil
    end
end

-- Load the key when the player joins or rejoins the game
game.Players.PlayerAdded:Connect(function(player)
    local key = loadKeyFromFile()
    if key then
        keyTextBox.Text = key
        onSuccess()  -- Automatically check the key on rejoin
    end
end)

-- Event for the "Get Key" button
getKeyButton.MouseButton1Click:Connect(function()
    local getKeyGUI = Instance.new("ScreenGui")
    getKeyGUI.Name = "GetKeyGUI"
    getKeyGUI.Enabled = true
    getKeyGUI.Parent = player:WaitForChild("PlayerGui")

    local keyEntryPanel = Instance.new("Frame")
    keyEntryPanel.Name = "KeyEntryPanel"
    keyEntryPanel.Position = UDim2.new(0.5, -150, 0.5, -75)
    keyEntryPanel.Size = UDim2.new(0, 300, 0, 150)
    keyEntryPanel.BackgroundTransparency = 0.5
    keyEntryPanel.Parent = getKeyGUI

    local keyEntryTextBox = Instance.new("TextBox")
    keyEntryTextBox.Name = "KeyEntryTextBox"
    keyEntryTextBox.Position = UDim2.new(0.5, -125, 0.5, -40)
    keyEntryTextBox.Size = UDim2.new(0, 250, 0, 30)
    keyEntryTextBox.Text = "Enter your key here..."
    keyEntryTextBox.Parent = keyEntryPanel

    local getKeyConfirmButton = Instance.new("TextButton")
    getKeyConfirmButton.Name = "GetKeyConfirmButton"
    getKeyConfirmButton.Position = UDim2.new(0.5, -75, 0.5, 40)
    getKeyConfirmButton.Size = UDim2.new(0, 150, 0, 30)
    getKeyConfirmButton.Text = "Confirm"
    getKeyConfirmButton.Parent = keyEntryPanel

    getKeyConfirmButton.MouseButton1Click:Connect(function()
        -- Set the entered key to the main GUI textbox
        keyTextBox.Text = keyEntryTextBox.Text
        saveKeyToFile(keyEntryTextBox.Text)
        onSuccess()  -- Automatically check the key when confirmed
        getKeyGUI:Destroy()  -- Close the "Get Key" GUI
    end)
end)

-- Event for the "Copy URL" button
local copyURLButton = Instance.new("TextButton")
copyURLButton.Name = "CopyURLButton"
copyURLButton.Position = UDim2.new(0.5, -50, 0.9, -15)
copyURLButton.Size = UDim2.new(0, 100, 0, 30)
copyURLButton.Text = "Copy URL"
copyURLButton.Parent = gui

copyURLButton.MouseButton1Click:Connect(function()
    local success, message = pcall(function()
        -- Try copying to clipboard using setclipboard and toclipboard
        setclipboard("https://link-hub.net/1030614/unknowntqhubcheckpoint1")
        toclipboard("https://link-hub.net/1030614/unknowntqhubcheckpoint1")
    end)

    if not success then
        print("Clipboard copy failed:", message)
    end
end)
